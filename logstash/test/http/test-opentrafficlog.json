{
  "fields": {
    "gatewayName": "API-Gateway 3",
    "gatewayRegion": "US"
  },
  "codec": "json_lines",
  "testcases": [
    {
      "description": "Test transactionElement event with leg0 having a serviceName and operation set",
      "input": [
        "{\"timestamp\":1594673918042,\"correlationId\":\"feca0c5f7f550c81357fdfXX\",\"processInfo\":{\"hostname\":\"ip-172-31-56-150.ec2.internal\",\"domainId\":\"e1ff3aab-3b11-4820-a1be-3763da2beda4\",\"groupId\":\"group-2\",\"groupName\":\"group-a\",\"serviceId\":\"instance-2\",\"serviceName\":\"instance-2\",\"version\":\"7.7.20200530\"},\"transactionElement\":{\"leg\":0,\"duration\":20,\"serviceName\":\"Petstore\",\"operation\":\"getInventory\",\"finalStatus\":\"Pass\",\"protocolInfo\":{\"http\":{\"uri\":\"/petstore/v2/store/inventory\",\"status\":200,\"statusText\":\"OK\",\"method\":\"GET\",\"vhost\":null,\"wafStatus\":0,\"bytesSent\":774,\"bytesReceived\":126,\"remoteName\":\"127.0.0.1\",\"remoteAddr\":\"127.0.0.1\",\"localAddr\":\"127.0.0.1\",\"remotePort\":\"59574\",\"localPort\":\"8065\",\"sslSubject\":null,\"authSubjectId\":\"180b1f32-d72f-40f4-949a-fc3f3f7dec2c\"},\"recvHeader\":\"GET /petstore/v2/store/inventory HTTP/1.0\\r\\nConnection: close\\r\\nHost: localhost\\r\\nKeyId: 6cd55c27-675a-444a-9bc7-ae9a7869184d\\r\\n\\r\\n\",\"sentHeader\":\"HTTP/1.1 200 OK\\r\\nMax-Forwards: 20\\r\\nVia: 1.0 ip-172-31-56-150.ec2.internal (Gateway)\\r\\nConnection: close\\r\\nX-CorrelationID: Id-feca0c5f7f550c81357fdfXX 0\\r\\ncache-control: no-store, no-cache, must-revalidate, proxy-revalidate\\r\\nDate: Mon, 13 Jul 2020 20:58:38 GMT\\r\\netag: W/\\\"52-LxypU3mP2zpjiEr7yZRKlgVdx3c\\\"\\r\\nexpires: 0\\r\\npragma: no-cache\\r\\nrequest-id: c190fa5f-a192-4e57-8eec-c75a6f52b90d\\r\\nresponse-time: 2\\r\\nserver: API Builder/4.28.10\\r\\nstart-time: 1594673918059\\r\\nsurrogate-control: no-store\\r\\nVary: Accept-Encoding\\r\\nx-content-type-options: nosniff\\r\\nx-frame-options: DENY\\r\\nx-xss-protection: 1; mode=block\\r\\ncontent-md5: 43364b0ef391a24f9a0e587356726c0d\\r\\ncontent-type: application/json; charset=utf-8\\r\\n\\r\\n\",\"recvPayload\":null,\"sentPayload\":null}}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-07-13T20:58:38.042Z",
          "correlationId": "feca0c5f7f550c81357fdfXX",
          "type": "summaryIndex",
          "duration": 20,
          "finalStatus": "Pass",
          "http": {
            "status": 200,
            "statusText": "OK",
            "uri": "/petstore/v2/store/inventory",
            "method": "GET",
            "vhost": null,
            "wafStatus": 0,
            "bytesSent": 774,
            "bytesReceived": 126,
            "remoteName": "127.0.0.1",
            "remoteAddr": "127.0.0.1",
            "localAddr": "127.0.0.1",
            "remotePort": "59574",
            "localPort": "8065",
            "sslSubject": null,
            "authSubjectId": "Plexus Suite - Patient Monitoring"
          },
          "processInfo": {
            "gatewayName": "API-Gateway 3",
            "gatewayRegion": "US",
            "groupId": "group-2",
            "groupName": "group-a",
            "hostname": "ip-172-31-56-150.ec2.internal",
            "serviceId": "instance-2",
            "version": "7.7.20200530"
          },
          "serviceContext": {
            "method": "getInventory",
            "service": "Petstore"
          }
        },
        {
          "@timestamp": "2020-07-13T20:58:38.042Z",
          "correlationId": "feca0c5f7f550c81357fdfXX",
          "processInfo": {
            "hostname": "ip-172-31-56-150.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-2",
            "version": "7.7.20200530", 
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionElements": {
            "leg0": {
              "duration": 20,
              "leg": 0,
              "serviceName": "Petstore",
              "operation": "getInventory",
              "finalStatus": "Pass",
              "protocolInfo": {
                "http": {
                  "uri": "/petstore/v2/store/inventory",
                  "status": 200,
                  "statusText": "OK",
                  "method": "GET",
                  "vhost": null,
                  "wafStatus": 0,
                  "bytesSent": 774,
                  "bytesReceived": 126,
                  "remoteName": "127.0.0.1",
                  "remoteAddr": "127.0.0.1",
                  "localAddr": "127.0.0.1",
                  "remotePort": "59574",
                  "localPort": "8065",
                  "sslSubject": null,
                  "authSubjectId": "180b1f32-d72f-40f4-949a-fc3f3f7dec2c"
                },
                "recvHeader": "GET /petstore/v2/store/inventory HTTP/1.0\r\nConnection: close\r\nHost: localhost\r\nKeyId: 6cd55c27-675a-444a-9bc7-ae9a7869184d\r\n\r\n",
                "sentHeader": "HTTP/1.1 200 OK\r\nMax-Forwards: 20\r\nVia: 1.0 ip-172-31-56-150.ec2.internal (Gateway)\r\nConnection: close\r\nX-CorrelationID: Id-feca0c5f7f550c81357fdfXX 0\r\ncache-control: no-store, no-cache, must-revalidate, proxy-revalidate\r\nDate: Mon, 13 Jul 2020 20:58:38 GMT\r\netag: W/\"52-LxypU3mP2zpjiEr7yZRKlgVdx3c\"\r\nexpires: 0\r\npragma: no-cache\r\nrequest-id: c190fa5f-a192-4e57-8eec-c75a6f52b90d\r\nresponse-time: 2\r\nserver: API Builder/4.28.10\r\nstart-time: 1594673918059\r\nsurrogate-control: no-store\r\nVary: Accept-Encoding\r\nx-content-type-options: nosniff\r\nx-frame-options: DENY\r\nx-xss-protection: 1; mode=block\r\ncontent-md5: 43364b0ef391a24f9a0e587356726c0d\r\ncontent-type: application/json; charset=utf-8\r\n\r\n",
                "recvPayload": null,
                "sentPayload": null
              }
            }
          }
        }
      ]
    },
    {
      "description": "Test transactionSummary event with an API exposed by the API-Manager",
      "input": [
        "{\"timestamp\":1594670847467,\"correlationId\":\"AAbe0c5f95da03f602a6e587\",\"processInfo\":{\"hostname\":\"ip-172-31-62-146.ec2.internal\",\"domainId\":\"e1ff3aab-3b11-4820-a1be-3763da2beda4\",\"groupId\":\"group-2\",\"groupName\":\"group-a\",\"serviceId\":\"instance-3\",\"serviceName\":\"instance-3\",\"version\":\"7.7.20200530\"},\"transactionSummary\":{\"path\":\"/petstore/v2/user/chris\", \"protocol\":\"https\", \"protocolSrc\":\"8065\", \"status\":\"success\", \"serviceContexts\":[{\"service\":\"Petstore\", \"monitor\":true, \"client\":\"8678678986896896\", \"org\":\"Apps org\", \"app\":\"Weather App\", \"method\":\"getUserByName\", \"status\":\"success\", \"duration\":2}]}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-07-13T20:07:27.467Z",
          "correlationId": "AAbe0c5f95da03f602a6e587",
          "customProperties": {},
          "finalStatus": "Pass",
          "protocol": "https",
          "protocolSrc": "8065",
          "processInfo": {
            "hostname": "ip-172-31-62-146.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-3",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "serviceContext": {
            "apiDeprecated": false,
            "apiOrg": "Mocked Org A",
            "apiState": "published",
            "apiVersion": "X.X.X",
            "service": "Petstore",
            "monitor": true,
            "appOrg": "Apps org",
            "app": "Weather App",
            "method": "getUserByName",
            "apiSecurity": "API-Key", 
            "requestPolicy": "N/A", 
            "routingPolicy": "N/A", 
            "responsePolicy": "N/A", 
            "faulthandlerPolicy": "N/A", 
            "backendBasePath": "https://petstore.swagger.io"
          },
          "type": "summaryIndex"
        },
        {
          "@timestamp": "2020-07-13T20:07:27.467Z",
          "correlationId": "AAbe0c5f95da03f602a6e587",
          "processInfo": {
            "hostname": "ip-172-31-62-146.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-3",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionSummary": {
            "path": "/petstore/v2/user/chris",
            "protocol": "https",
            "protocolSrc": "8065",
            "status": "success",
            "customProperties": {},
            "serviceContext": {
              "apiDeprecated": false,
              "apiOrg": "Mocked Org A",
              "apiState": "published",
              "apiVersion": "X.X.X",
              "service": "Petstore",
              "monitor": true,
              "appOrg": "Apps org",
              "app": "Weather App",
              "method": "getUserByName",
              "apiSecurity": "API-Key", 
              "requestPolicy": "N/A", 
              "routingPolicy": "N/A", 
              "responsePolicy": "N/A", 
              "faulthandlerPolicy": "N/A", 
              "backendBasePath": "https://petstore.swagger.io"
            }
          }
        }
      ]
    },
    {
      "description": "Test API that should include policies, OAuth security and a special backend",
      "input": [
        "{\"timestamp\":1594670847467,\"correlationId\":\"BBbe0c5f95da03f602a6e587\",\"processInfo\":{\"hostname\":\"ip-172-31-62-146.ec2.internal\",\"domainId\":\"e1ff3aab-3b11-4820-a1be-3763da2beda4\",\"groupId\":\"group-2\",\"groupName\":\"group-a\",\"serviceId\":\"instance-3\",\"serviceName\":\"instance-3\",\"version\":\"7.7.20200530\"},\"transactionSummary\":{\"path\":\"/api/with/policies/backend/and/oauth\", \"protocol\":\"https\", \"protocolSrc\":\"8065\", \"status\":\"success\", \"serviceContexts\":[{\"service\":\"Petstore\", \"monitor\":true, \"client\":\"8678678986896896\", \"org\":\"Apps org\", \"app\":\"Weather App\", \"method\":\"getUserByName\", \"status\":\"success\", \"duration\":2}]}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-07-13T20:07:27.467Z",
          "correlationId": "BBbe0c5f95da03f602a6e587",
          "customProperties": {
            "customProperty1": "value 1",
            "customProperty2": "value 2",
            "customProperty3": "value 3"
          },
          "finalStatus": "Pass",
          "protocol": "https",
          "protocolSrc": "8065",
          "type": "summaryIndex",
          "serviceContext": {
            "apiDeprecated": true,
            "apiOrg": "Mocked Org B",
            "apiState": "unpublished",
            "apiVersion": "Z.Z.Z",
            "service": "Petstore",
            "monitor": true,
            "appOrg": "Apps org",
            "app": "Weather App",
            "method": "getUserByName",
            "apiSecurity": "OAuth", 
            "requestPolicy": "My Request Policy", 
            "routingPolicy": "I do the routing", 
            "responsePolicy": "I take care abouth the response", 
            "faulthandlerPolicy": "OMG Errors", 
            "backendBasePath": "https://im.a.special.backend.host:7788"
          },
          "processInfo": {
            "hostname": "ip-172-31-62-146.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-3",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          }
        },
        {
          "@timestamp": "2020-07-13T20:07:27.467Z",
          "correlationId": "BBbe0c5f95da03f602a6e587",
          "processInfo": {
            "hostname": "ip-172-31-62-146.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-3",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionSummary": {
            "path": "/api/with/policies/backend/and/oauth",
            "protocol": "https",
            "protocolSrc": "8065",
            "status": "success",
            "customProperties": {
              "customProperty1": "value 1",
              "customProperty2": "value 2",
              "customProperty3": "value 3"
            },
            "serviceContext": {
              "apiDeprecated": true,
              "apiOrg": "Mocked Org B",
              "apiState": "unpublished",
              "apiVersion": "Z.Z.Z",
              "service": "Petstore",
              "monitor": true,
              "appOrg": "Apps org",
              "app": "Weather App",
              "method": "getUserByName",
              "apiSecurity": "OAuth", 
              "requestPolicy": "My Request Policy", 
              "routingPolicy": "I do the routing", 
              "responsePolicy": "I take care abouth the response", 
              "faulthandlerPolicy": "OMG Errors", 
              "backendBasePath": "https://im.a.special.backend.host:7788"
            }
          }
        }
      ]
    },
    {
      "description": "Test transactionSummary event with unknwon API that cannot be looked up",
      "input": [
        "{\"timestamp\":1594670847467,\"correlationId\":\"OMG-UNKNOWN-API\",\"processInfo\":{\"hostname\":\"ip-172-31-62-146.ec2.internal\",\"domainId\":\"e1ff3aab-3b11-4820-a1be-3763da2beda4\",\"groupId\":\"group-2\",\"groupName\":\"group-a\",\"serviceId\":\"instance-3\",\"serviceName\":\"instance-3\",\"version\":\"7.7.20200530\"},\"transactionSummary\":{\"path\":\"/this/api/is/unknown\", \"protocol\":\"https\", \"protocolSrc\":\"8065\", \"status\":\"success\", \"serviceContexts\":[{\"service\":\"A unknown API\", \"monitor\":true, \"client\":null, \"org\":null, \"app\":null, \"method\":\"getUserByName\", \"status\":\"success\", \"duration\":2}]}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-07-13T20:07:27.467Z",
          "correlationId": "OMG-UNKNOWN-API",
          "finalStatus": "Pass",
          "protocol": "https",
          "protocolSrc": "8065",
          "serviceContext": {
            "service": "A unknown API",
            "monitor": true,
            "appOrg": null,
            "app": null,
            "method": "getUserByName"
          }, 
          "type": "summaryIndex",
          "processInfo": {
            "hostname": "ip-172-31-62-146.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-3",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "tags": ["_httprequestfailure"]
        },
        {
          "@timestamp": "2020-07-13T20:07:27.467Z",
          "correlationId": "OMG-UNKNOWN-API",
          "processInfo": {
            "hostname": "ip-172-31-62-146.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-3",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionSummary": {
            "path": "/this/api/is/unknown",
            "protocol": "https",
            "protocolSrc": "8065",
            "status": "success",
            "serviceContext": {
              "service": "A unknown API",
              "monitor": true,
              "appOrg": null,
              "app": null,
              "method": "getUserByName"
            }
          },
          "tags": ["_httprequestfailure"]
        }
      ]
    },
    {
      "description": "Test transactionSummary without ServiceConext event",
      "input": [
        "{\"timestamp\":1594665615973,\"correlationId\":\"8faa0c5f4da87df2ad8c394a\",\"processInfo\":{\"hostname\":\"ip-172-31-48-17.ec2.internal\",\"domainId\":\"e1ff3aab-3b11-4820-a1be-3763da2beda4\",\"groupId\":\"group-2\",\"groupName\":\"group-a\",\"serviceId\":\"instance-1\",\"serviceName\":\"instance-1\",\"version\":\"7.7.20200530\"},\"transactionSummary\":{\"path\":\"/healthcheck\", \"protocol\":\"http\", \"protocolSrc\":\"8080\", \"status\":\"success\", \"serviceContexts\":[]}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-07-13T18:40:15.973Z",
          "correlationId": "8faa0c5f4da87df2ad8c394a",
          "finalStatus": "Pass",
          "protocol": "http",
          "protocolSrc": "8080",
          "serviceContext": {
            "apiDeprecated": true,
            "apiOrg": "Mocked Org B",
            "apiState": "unpublished",
            "apiVersion": "Z.Z.Z"
          },
          "customProperties": {},
          "type": "summaryIndex",
          "processInfo": {
            "hostname": "ip-172-31-48-17.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-1",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          }
        },
        {
          "@timestamp": "2020-07-13T18:40:15.973Z",
          "correlationId": "8faa0c5f4da87df2ad8c394a",
          "processInfo": {
            "hostname": "ip-172-31-48-17.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-1",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionSummary": {
            "path": "/healthcheck",
            "protocol": "http",
            "protocolSrc": "8080",
            "status": "success",
            "serviceContext": {
              "apiDeprecated": true,
              "apiOrg": "Mocked Org B",
              "apiState": "unpublished",
              "apiVersion": "Z.Z.Z"
            },
            "customProperties": {}
          }
        }
      ]
    },
    {
      "description": "Test ciruitPath event",
      "input": [
        "{\"timestamp\":1594673939577,\"correlationId\":\"13cb0c5f2d58b335499405fa\",\"processInfo\":{\"hostname\":\"ip-172-31-56-150.ec2.internal\",\"domainId\":\"e1ff3aab-3b11-4820-a1be-3763da2beda4\",\"groupId\":\"group-2\",\"groupName\":\"group-a\",\"serviceId\":\"instance-2\",\"serviceName\":\"instance-2\",\"version\":\"7.7.20200530\"},\"circuitPath\":[ { \"policy\": \"API Broker\", \"execTime\": 46, \"filters\": [  { \"name\": \"Set service context\", \"type\": \"VApiServiceContextFilter\", \"class\": \"com.vordel.circuit.vapi.VApiServiceContextFilter\", \"status\": \"Pass\", \"filterTime\": 1594673939531, \"execTime\": 0 } , { \"name\": \"Custom Routing\", \"type\": \"VApiCircuitDelegateFilter\", \"class\": \"com.vordel.apiportal.runtime.virtualized.VApiCircuitDelegateFilter\", \"status\": \"Pass\", \"filterTime\": 1594673939577, \"execTime\": 46, \"subPaths\": [  { \"policy\": \"Default API Proxy Routing\", \"execTime\": 46, \"filters\": [  { \"espk\": \"DEFAULT_PRIMARY_VordelGateway_7.7.0:-2948634492645772937\", \"name\": \"Default Routing\", \"type\": \"SwitchFilter\", \"class\": \"com.vordel.circuit.switchcase.SwitchFilter\", \"status\": \"Pass\", \"filterTime\": 1594673939577, \"execTime\": 46, \"subPaths\": [  { \"policy\": \"Default API Proxy Routing\", \"execTime\": 46, \"filters\": [  { \"name\": \"not-required-here\", \"type\": \"CircuitDelegateFilter\", \"class\": \"com.vordel.circuit.CircuitDelegateFilter\", \"status\": \"Pass\", \"filterTime\": 1594673939577, \"execTime\": 46, \"subPaths\": [  { \"policy\": \"Default Profile-based Routing\", \"execTime\": 46, \"filters\": [  { \"espk\": \"DEFAULT_PRIMARY_VordelGateway_7.7.0:-3718249635933793053\", \"name\": \"Connect to URL\", \"type\": \"ConnectToURLFilter\", \"class\": \"com.vordel.circuit.net.ConnectToURLFilter\", \"status\": \"Pass\", \"filterTime\": 1594673939577, \"execTime\": 46 }  ] }  ]  }  ] }  ]  }  ] }  ]  }  ] } ]}"
      ],
      "expected": [
        {
          "@timestamp": "2020-07-13T20:58:59.577Z",
          "correlationId": "13cb0c5f2d58b335499405fa",
          "processInfo": {
            "hostname": "ip-172-31-56-150.ec2.internal",
            "groupId": "group-2",
            "groupName": "group-a",
            "serviceId": "instance-2",
            "version": "7.7.20200530",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "circuitPath": [
            {
              "policy": "API Broker",
              "execTime": 46,
              "filters": [
                {
                  "name": "Set service context",
                  "type": "VApiServiceContextFilter",
                  "class": "com.vordel.circuit.vapi.VApiServiceContextFilter",
                  "status": "Pass",
                  "filterTime": 1594673939531,
                  "execTime": 0
                },
                {
                  "name": "Custom Routing",
                  "type": "VApiCircuitDelegateFilter",
                  "class": "com.vordel.apiportal.runtime.virtualized.VApiCircuitDelegateFilter",
                  "status": "Pass",
                  "filterTime": 1594673939577,
                  "execTime": 46,
                  "subPaths": [
                    {
                      "policy": "Default API Proxy Routing",
                      "execTime": 46,
                      "filters": [
                        {
                          "espk": "DEFAULT_PRIMARY_VordelGateway_7.7.0:-2948634492645772937",
                          "name": "Default Routing",
                          "type": "SwitchFilter",
                          "class": "com.vordel.circuit.switchcase.SwitchFilter",
                          "status": "Pass",
                          "filterTime": 1594673939577,
                          "execTime": 46,
                          "subPaths": [
                            {
                              "policy": "Default API Proxy Routing",
                              "execTime": 46,
                              "filters": [
                                {
                                  "name": "not-required-here",
                                  "type": "CircuitDelegateFilter",
                                  "class": "com.vordel.circuit.CircuitDelegateFilter",
                                  "status": "Pass",
                                  "filterTime": 1594673939577,
                                  "execTime": 46,
                                  "subPaths": [
                                    {
                                      "policy": "Default Profile-based Routing",
                                      "execTime": 46,
                                      "filters": [
                                        {
                                          "espk": "DEFAULT_PRIMARY_VordelGateway_7.7.0:-3718249635933793053",
                                          "name": "Connect to URL",
                                          "type": "ConnectToURLFilter",
                                          "class": "com.vordel.circuit.net.ConnectToURLFilter",
                                          "status": "Pass",
                                          "filterTime": 1594673939577,
                                          "execTime": 46
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "description": "A scheduled policy",
      "input": [
        "{\"timestamp\":1598271030003,\"correlationId\":\"36ae435faa3e258ee1092b60\",\"processInfo\":{\"hostname\":\"api-env\",\"domainId\":\"ed992442-c363-4d36-963a-9e6314b0f421\",\"groupId\":\"group-2\",\"groupName\":\"QuickStart Group\",\"serviceId\":\"instance-1\",\"serviceName\":\"QuickStart Server\",\"version\":\"7.7.20200730\"},\"transactionSummary\":{\"path\":null, \"protocol\":null, \"protocolSrc\":null, \"status\":\"success\", \"serviceContexts\":[]}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-08-24T12:10:30.003Z",
          "correlationId": "36ae435faa3e258ee1092b60",
          "processInfo": {
            "hostname": "api-env",
            "groupId": "group-2",
            "groupName": "QuickStart Group",
            "serviceId": "instance-1",
            "version": "7.7.20200730",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionElements": {
            "leg0": {
              "finalStatus": "Pass",
              "protocolInfo": {
                "http": {
                  "uri": "N/A",
                  "status": "901",
                  "statusText": "OK",
                  "method": "N/A"
                }
              }
            }
          },
          "transactionSummary": {
            "path": null,
            "protocol": null,
            "protocolSrc": null,
            "status": "success",
            "duration": "-1",
            "serviceContext": {
              "method": "N/A",
              "service": "Scheduled policy"
            }
          },
          "type": "scheduledPolicy"
        }
      ]
    },
    {
      "description": "OPTIONS request circuitPath",
      "input": [
        "{\"timestamp\":1600184256489,\"correlationId\":\"c0df605fa2047bebb989e684\",\"processInfo\":{\"hostname\":\"api-env\",\"domainId\":\"ed992442-c363-4d36-963a-9e6314b0f421\",\"groupId\":\"group-2\",\"groupName\":\"QuickStart Group\",\"serviceId\":\"instance-1\",\"serviceName\":\"QuickStart Server\",\"version\":\"7.7.20200730\"},\"circuitPath\":[  ]}"
      ],
      "expected": [
        {
          "@timestamp": "2020-09-15T15:37:36.489Z",
          "correlationId": "c0df605fa2047bebb989e684",
          "processInfo": {
            "hostname": "api-env",
            "groupId": "group-2",
            "groupName": "QuickStart Group",
            "serviceId": "instance-1",
            "version": "7.7.20200730",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "circuitPath": []
        }
      ]
    },
    {
      "description": "OPTIONS request: TransactionElement event with leg0",
      "input": [
        "{\"timestamp\":1600184256487,\"correlationId\":\"c0df605fa2047bebbOPTIONS\",\"processInfo\":{\"hostname\":\"api-env\",\"domainId\":\"ed992442-c363-4d36-963a-9e6314b0f421\",\"groupId\":\"group-2\",\"groupName\":\"QuickStart Group\",\"serviceId\":\"instance-1\",\"serviceName\":\"QuickStart Server\",\"version\":\"7.7.20200730\"},\"transactionElement\":{\"leg\":0,\"duration\":2,\"serviceName\":null,\"operation\":null,\"finalStatus\":null,\"protocolInfo\":{\"http\":{\"uri\":\"/WebShop.svc\",\"status\":200,\"statusText\":\"OK\",\"method\":\"OPTIONS\",\"vhost\":null,\"wafStatus\":0,\"bytesSent\":212,\"bytesReceived\":477,\"remoteName\":\"192.168.65.1\",\"remoteAddr\":\"192.168.65.1\",\"localAddr\":\"192.168.65.133\",\"remotePort\":\"60041\",\"localPort\":\"8065\",\"sslSubject\":null,\"authSubjectId\":null},\"recvHeader\":\"OPTIONS \/WebShop.svc HTTP\/1.1\\r\\nHost: api-env:8065\\r\\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko\/20100101 Firefox\/80.0\\r\\nAccept: *\/*\\r\\nAccept-Language: en-US,en;q=0.5\\r\\nAccept-Encoding: gzip, deflate, br\\r\\nAccess-Control-Request-Method: POST\\r\\nAccess-Control-Request-Headers: content-type,keyid,soapaction,x-requested-with\\r\\nReferer: https:\/\/api-env:8075\/home\\r\\nOrigin: https:\/\/api-env:8075\\r\\nConnection: keep-alive\\r\\nPragma: no-cache\\r\\nCache-Control: no-cache\\r\\n\\r\\n\",\"sentHeader\":\"HTTP\/1.1 200 OK\\r\\nDate: Tue, 15 Sep 2020 15:37:36 GMT\\r\\nAllow: GET, HEAD, OPTIONS\\r\\nServer: Gateway\\r\\nContent-Length: 0\\r\\nConnection: close\\r\\nX-CorrelationID: Id-c0df605fa2047bebb989e684 0\\r\\nContent-Type: text\/plain\\r\\n\\r\\n\",\"recvPayload\":null,\"sentPayload\":null}}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-09-15T15:37:36.487Z",
          "correlationId": "c0df605fa2047bebbOPTIONS",
          "type": "summaryIndex",
          "tags": [],
          "duration": 2,
          "finalStatus": "Pass",
          "processInfo": {
            "hostname": "api-env",
            "groupId": "group-2",
            "groupName": "QuickStart Group",
            "serviceId": "instance-1",
            "version": "7.7.20200730",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "http": {
            "status": 200,
            "statusText": "OK",
            "method": "OPTIONS",
            "uri": "/WebShop.svc",
            "vhost": null,
            "wafStatus": 0,
            "bytesSent": 212,
            "bytesReceived": 477,
            "remoteName": "192.168.65.1",
            "remoteAddr": "192.168.65.1",
            "localAddr": "192.168.65.133",
            "remotePort": "60041",
            "localPort": "8065",
            "sslSubject": null,
            "authSubjectId": null
          }
        },
        {
          "@timestamp": "2020-09-15T15:37:36.487Z",
          "correlationId": "c0df605fa2047bebbOPTIONS",
          "processInfo": {
            "hostname": "api-env",
            "groupId": "group-2",
            "groupName": "QuickStart Group",
            "serviceId": "instance-1",
            "version": "7.7.20200730", 
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "transactionElements": {
            "leg0": {
              "duration": 2,
              "leg": 0,
              "operation": null,
              "serviceName": null,
              "finalStatus": null,
              "protocolInfo": {
                "http": {
                  "uri": "/WebShop.svc",
                  "status": 200,
                  "statusText": "OK",
                  "method": "OPTIONS",
                  "vhost": null,
                  "wafStatus": 0,
                  "bytesSent": 212,
                  "bytesReceived": 477,
                  "remoteName": "192.168.65.1",
                  "remoteAddr": "192.168.65.1",
                  "localAddr": "192.168.65.133",
                  "remotePort": "60041",
                  "localPort": "8065",
                  "sslSubject": null,
                  "authSubjectId": null
                },
                "recvHeader": "OPTIONS \/WebShop.svc HTTP\/1.1\r\nHost: api-env:8065\r\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:80.0) Gecko\/20100101 Firefox\/80.0\r\nAccept: *\/*\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate, br\r\nAccess-Control-Request-Method: POST\r\nAccess-Control-Request-Headers: content-type,keyid,soapaction,x-requested-with\r\nReferer: https:\/\/api-env:8075\/home\r\nOrigin: https:\/\/api-env:8075\r\nConnection: keep-alive\r\nPragma: no-cache\r\nCache-Control: no-cache\r\n\r\n",
                "sentHeader": "HTTP\/1.1 200 OK\r\nDate: Tue, 15 Sep 2020 15:37:36 GMT\r\nAllow: GET, HEAD, OPTIONS\r\nServer: Gateway\r\nContent-Length: 0\r\nConnection: close\r\nX-CorrelationID: Id-c0df605fa2047bebb989e684 0\r\nContent-Type: text\/plain\r\n\r\n",
                "recvPayload": null,
                "sentPayload": null
              }
            }
          }
        }
      ]
    },
    {
      "description": "Validate favicon.ico request (TransactionElement) is ignored (ignore: true)",
      "input": [
        "{\"timestamp\":1608229479164,\"correlationId\":\"67a2db5ff1bec8251e3f67af\",\"processInfo\":{\"hostname\":\"api-env\",\"domainId\":\"ed992442-c363-4d36-963a-9e6314b0f421\",\"groupId\":\"group-2\",\"groupName\":\"QuickStart Group\",\"serviceId\":\"instance-1\",\"serviceName\":\"QuickStart Server\",\"version\":\"7.7.20200930\"},\"transactionElement\":{\"leg\":0,\"duration\":1,\"serviceName\":null,\"operation\":null,\"finalStatus\":null,\"protocolInfo\":{\"http\":{\"uri\":\"/favicon.ico\",\"status\":200,\"statusText\":\"OK\",\"method\":\"GET\",\"vhost\":null,\"wafStatus\":0,\"bytesSent\":5570,\"bytesReceived\":523,\"remoteName\":\"192.168.65.1\",\"remoteAddr\":\"192.168.65.1\",\"localAddr\":\"192.168.65.134\",\"remotePort\":\"63726\",\"localPort\":\"8080\",\"sslSubject\":null,\"authSubjectId\":null},\"recvHeader\":\"GET \/favicon.ico HTTP\/1.1\\r\\nHost: api-env:8080\\r\\nUser-Agent: Mozilla\/5.0 (Windows NT 10.0; Win64; x64; rv:84.0) Gecko\/20100101 Firefox\/84.0\\r\\nAccept: text\/html,application\/xhtml+xml,application\/xml;q=0.9,image\/webp,*\/*;q=0.8\\r\\nAccept-Language: en-US,en;q=0.5\\r\\nAccept-Encoding: gzip, deflate\\r\\nConnection: keep-alive\\r\\nCookie: _ga=GA1.1.177509375.1593442001; cookie_pressed_153=false; _rdt_uuid=1605268895083.5433b245-3b02-4dc3-b82f-1460ef4cccbb; _fbp=fb.0.1605268896590.263596046; iconSize=16x16\\r\\nUpgrade-Insecure-Requests: 1\\r\\n\\r\\n\",\"sentHeader\":\"HTTP\/1.1 200 OK\\r\\nDate: Thu, 17 Dec 2020 18:24:39 GMT\\r\\nServer: Gateway\\r\\nConnection: close\\r\\nX-CorrelationID: Id-67a2db5ff1bec8251e3f67af 0\\r\\n\\r\\n\",\"recvPayload\":null,\"sentPayload\":null}}}"
      ],
      "expected": []
    },
    {
      "description": "Validate specific CircuitPath(Policy)-Document is ignored (ignore: true)",
      "input": [
        "{\"timestamp\":1608241621366,\"correlationId\":\"d5d1db5ff6be30289e509467\",\"processInfo\":{\"hostname\":\"api-env\",\"domainId\":\"ed992442-c363-4d36-963a-9e6314b0f421\",\"groupId\":\"group-2\",\"groupName\":\"QuickStart Group\",\"serviceId\":\"instance-1\",\"serviceName\":\"QuickStart Server\",\"version\":\"7.7.20200930\"},\"circuitPath\":[ { \"policy\": \"Do not index this Policy\", \"execTime\": 0, \"filters\": [  { \"espk\": \"PrimaryStore-d1fbf001-919b-4ebe-b389-4b341936e408:-5392028379814661683\", \"name\": \"Set Message\", \"type\": \"ChangeMessageFilter\", \"class\": \"com.vordel.circuit.conversion.ChangeMessageFilter\", \"status\": \"Pass\", \"filterTime\": 1608241621359, \"execTime\": 0 } , { \"espk\": \"PrimaryStore-d1fbf001-919b-4ebe-b389-4b341936e408:1862930145894356902\", \"name\": \"Reflect\", \"type\": \"ReflectFilter\", \"class\": \"com.vordel.circuit.net.ReflectFilter\", \"status\": \"Pass\", \"filterTime\": 1608241621359, \"execTime\": 0 }  ] } ]}"
      ],
      "expected": []
    },
    {
      "description": "Validate TransactionSummary event with specific path is ignored (ignore: true)",
      "input": [
        "{\"timestamp\":1608318768751,\"correlationId\":\"30ffdc5f2ec9f0c26e65fce2\",\"processInfo\":{\"hostname\":\"api-env\",\"domainId\":\"ed992442-c363-4d36-963a-9e6314b0f421\",\"groupId\":\"group-2\",\"groupName\":\"QuickStart Group\",\"serviceId\":\"instance-1\",\"serviceName\":\"QuickStart Server\",\"version\":\"7.7.20200930\"},\"transactionSummary\":{\"path\":\"/favicon.ico\", \"protocol\":\"http\", \"protocolSrc\":\"8080\", \"status\":\"success\", \"serviceContexts\":[]}}"
      ],
      "expected": []
    },
    {
      "description": "JMS leg that should skip any lookups (Checked there is no request tag in the output",
      "input": [
        "{\"timestamp\":1615979426799,\"correlationId\":\"a1e3516071b71fe9e3bdb25b\",\"processInfo\":{\"hostname\":\"api-back-11\",\"domainId\":\"973fdd33-69fd-4a0f-aacf-e430d70da6d3\",\"groupId\":\"group-3\",\"groupName\":\"Back\",\"serviceId\":\"instance-3\",\"serviceName\":\"service.customer.com\",\"version\":\"7.7.20201130\"},\"transactionElement\":{\"leg\":2,\"duration\":0,\"serviceName\":null,\"operation\":null,\"finalStatus\":null,\"protocolInfo\":{\"jms\":{\"jmsMessageID\":\"ID:0180255ae31a25b22-37877-1615931207546-741:1:107:98:1\",\"jmsCorrelationID\":\"Id-a1e3516071b71fe9e3bdb25b\",\"jmsDestination\":\"queue://com.customer.YELLOW.msg.WWSWO.TEST.XYZACEvent_OQ\",\"jmsProviderURL\":\"local\",\"jmsDeliveryMode\":2,\"jmsPriority\":4,\"jmsReplyTo\":\"\",\"jmsRedelivered\":0,\"jmsTimestamp\":1615979426802,\"jmsExpiration\":0,\"jmsType\":\"BytesMessage\",\"jmsStatus\":\"Success\",\"jmsStatusText\":null,\"authSubjectId\":null},\"recvHeader\":null,\"sentHeader\":\"Any sent header\",\"recvPayload\":null,\"sentPayload\":\"file:///Cloud/shared/Openlogs/2021-03-17/12.10/a1e3516071b71fe9e3bdb25b-2-sent\"}}}"
      ],
      "expected": [
        {
          "@timestamp": "2021-03-17T11:10:26.799Z",
          "correlationId": "a1e3516071b71fe9e3bdb25b",
          "processInfo": {
            "gatewayName": "API-Gateway 3",
            "gatewayRegion": "US",
            "groupId": "group-3",
            "groupName": "Back",
            "hostname": "api-back-11",
            "serviceId": "instance-3",
            "version": "7.7.20201130"
          },
          "transactionElements": {
            "leg2": {
              "duration": 0,
              "finalStatus": null,
              "leg": 2,
              "operation": null,
              "serviceName": null,
              "protocolInfo": {
                "jms": {
                  "authSubjectId": null,
                  "jmsCorrelationID": "Id-a1e3516071b71fe9e3bdb25b",
                  "jmsDeliveryMode": 2,
                  "jmsDestination": "queue://com.customer.YELLOW.msg.WWSWO.TEST.XYZACEvent_OQ",
                  "jmsExpiration": 0,
                  "jmsMessageID": "ID:0180255ae31a25b22-37877-1615931207546-741:1:107:98:1",
                  "jmsPriority": 4,
                  "jmsProviderURL": "local",
                  "jmsRedelivered": 0,
                  "jmsReplyTo": "",
                  "jmsStatus": "Success",
                  "jmsStatusText": null,
                  "jmsTimestamp": 1615979426802,
                  "jmsType": "BytesMessage"
                },
                "recvHeader": null,
                "recvPayload": null,
                "sentHeader": "Any sent header",
                "sentPayload": "file:///Cloud/shared/Openlogs/2021-03-17/12.10/a1e3516071b71fe9e3bdb25b-2-sent"
              }
            }
          }
        }
      ]
    },
    {
      "description": "Transaction-Element Leg-0 having an SSL-Subject set.",
      "input": [
        "{\"timestamp\":1619688909827,\"correlationId\":\"cd7d8a6097b7669f3d48c5b6\",\"processInfo\":{\"hostname\":\"api-front-11\",\"domainId\":\"8591ad8b-c13d-492a-83cd-c3f937bb91bd\",\"groupId\":\"group-3\",\"groupName\":\"Front\",\"serviceId\":\"instance-3\",\"serviceName\":\"api-front-11.prd.schenkerag.de.axway.cloud\",\"version\":\"7.7.20201130\"},\"transactionElement\":{\"leg\":0,\"duration\":26,\"serviceName\":\"MapService\",\"operation\":null,\"finalStatus\":null,\"protocolInfo\":{\"http\":{\"uri\":\"/mapservice/v1/data/v3/1/1/1.pbf\",\"status\":200,\"statusText\":\"OK\",\"method\":\"OPTIONS\",\"vhost\":null,\"wafStatus\":0,\"bytesSent\":617,\"bytesReceived\":723,\"remoteName\":\"localhost\",\"remoteAddr\":\"127.0.0.1\",\"localAddr\":\"127.0.0.1\",\"remotePort\":\"8065\",\"localPort\":\"55640\",\"sslSubject\":\"/CN=Change this for production\",\"authSubjectId\":null},\"recvHeader\":\"Any received header\",\"sentHeader\":\"Any sent header\",\"recvPayload\":\"file:\/\/\/Cloud\/shared\/Openlogs\/2021-04-29\/11.35\/cd7d8a6097b7669f3d48c5b6-1-received\",\"sentPayload\":null}}}"
      ],
      "expected": [
        {
          "@timestamp": "2020-09-15T15:37:36.487Z",
          "correlationId": "cd7d8a6097b7669f3d48c5b6",
          "type": "summaryIndex",
          "tags": [],
          "duration": 2,
          "finalStatus": "Pass",
          "processInfo": {
            "hostname": "api-env",
            "groupId": "group-2",
            "groupName": "QuickStart Group",
            "serviceId": "instance-1",
            "version": "7.7.20200730",
            "gatewayName": "API-Gateway 3", 
            "gatewayRegion": "US"
          },
          "http": {
            "status": 200,
            "statusText": "OK",
            "method": "OPTIONS",
            "uri": "/WebShop.svc",
            "vhost": null,
            "wafStatus": 0,
            "bytesSent": 212,
            "bytesReceived": 477,
            "remoteName": "192.168.65.1",
            "remoteAddr": "192.168.65.1",
            "localAddr": "192.168.65.133",
            "remotePort": "60041",
            "localPort": "8065",
            "sslSubject": null,
            "authSubjectId": null
          }
        },
        {
          "@timestamp": "2021-03-17T11:10:26.799Z",
          "correlationId": "cd7d8a6097b7669f3d48c5b6",
          "processInfo": {
            "gatewayName": "API-Gateway 3",
            "gatewayRegion": "US",
            "groupId": "group-3",
            "groupName": "Front",
            "hostname": "api-front-11",
            "serviceId": "instance-3",
            "version": "7.7.20201130"
          },
          "transactionElements": {
            "leg0": {
              "duration": 26,
              "finalStatus": null,
              "leg": 0,
              "operation": null,
              "serviceName": "MapService",
              "protocolInfo": {
                "http": {
                  "uri": "/mapservice/v1/data/v3/1/1/1.pbf",
                  "status": 200,
                  "statusText": "OK",
                  "method": "OPTIONS",
                  "vhost": null,
                  "wafStatus": 0,
                  "bytesSent": 617,
                  "bytesReceived": 723,
                  "remoteName": "localhost",
                  "remoteAddr": "127.0.0.1",
                  "localAddr": "127.0.0.1",
                  "remotePort": "8065",
                  "localPort": "55640",
                  "sslSubject": "/CN=Change this for production",
                  "authSubjectId": null
                },
                "recvHeader": "Any received header",
                "recvPayload": "file:\/\/\/Cloud\/shared\/Openlogs\/2021-04-29\/11.35\/cd7d8a6097b7669f3d48c5b6-1-received",
                "sentHeader": "Any sent header",
                "sentPayload": null
              }
            }
          }
        }
      ]
    }
  ]
}
